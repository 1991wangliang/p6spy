# Known Issues

## Non-standard (driver specific) JDBC methods are not supported without using a workaround.

Many drivers provide methods that expose driver-specific, non-standard functionality. Most developers do not use
these features, but in the event that an application does use these features they are not natively supported by
P6Spy. For example, the MySQL JDBC drivers allow you to call the auto-increment function as follows:

    ((com.mysql.jdbc.PreparedStatement)stmt).getLastInsertId();

That cast fails when P6Spy is active since the prepared statement is actually a proxy generated by P6Spy. Since
the proxy is not a subclass of com.mysql.jdbc.PreparedStatement, the cast fails.  The only workaround available
requires code changes to the application.

All proxies generated by P6Spy implement the P6Proxy interface.  P6Proxy has a method named getUnderlying().  This
method will return the underlying object which is being proxied.  This method can be used to gain access to the
vendor specific methods as shown in the code example below.

    // assuming MySQL JDBC driver
    PreparedStatement stmt = connection.prepareStatement("....");
    if( stmt instanceof P6Proxy ) {
      stmt = ((P6Proxy)stmt).getUnderlying();
    }
    ((com.mysql.jdbc.PreparedStatement)stmt).getLastInsertId();

Ideally, a long-term, native solution will be provided. One idea under consideration is to use load time weaving as
an alternative to proxy classes.  However, this is not yet under development and other suggestions are welcome.
